<!DOCTYPE html>
<html>
<head>
    <title>系统监控</title>
    <meta charset="utf-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .metric {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .progress {
            width: 100%;
            height: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        .progress-value {
            position: absolute;
            height: 100%;
            background-color: #4CAF50;
            left: 0;
            top: 0;
            transition: width 0.5s;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        h2 {
            color: #666;
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        .file-list {
            margin-top: 30px;
        }
        .file-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 1px solid #ddd;
            margin-bottom: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .file-item:hover {
            background-color: #f5f5f5;
        }
        .file-icon {
            margin-right: 10px;
            font-size: 24px;
        }
        .file-info {
            flex-grow: 1;
        }
        .file-actions {
            display: flex;
            gap: 10px;
        }
        .file-actions a {
            text-decoration: none;
            color: #4CAF50;
        }
        .upload-form {
            margin: 20px 0;
            padding: 20px;
            border: 2px dashed #ddd;
            border-radius: 5px;
            text-align: center;
        }
        .network-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        .network-item {
            background-color: #f8f8f8;
            padding: 10px;
            border-radius: 5px;
        }
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 8px 15px;
            background-color: #f44336;
            color: white;
            text-decoration: none;
            border-radius: 5px;
        }
        .logout-btn:hover {
            background-color: #d32f2f;
        }
        .upload-form input[type="file"] {
            padding: 10px;
            margin-right: 10px;
        }
        .upload-form input[type="submit"] {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .upload-form input[type="submit"]:hover {
            background-color: #45a049;
        }
        .upload-progress {
            display: none;
            margin-top: 10px;
        }
        .upload-progress .progress {
            height: 10px;
            margin-top: 5px;
        }
        .error-message {
            color: #f44336;
            margin-top: 10px;
            display: none;
        }
        .success-message {
            color: #4CAF50;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    {% include 'nav.html' %}
    <div class="container">
        <h1>系统监控面板</h1>
        
        <div class="metric">
            <h2>CPU 使用率: <span id="cpu-text">{{ cpu_percent }}</span>%</h2>
            <div class="progress">
                <div id="cpu-bar" class="progress-value"></div>
            </div>
        </div>

        <div class="metric">
            <h2>内存使用率: <span id="mem-text">{{ memory_percent }}</span>%</h2>
            <div class="progress">
                <div id="mem-bar" class="progress-value"></div>
            </div>
        </div>

        <div class="metric">
            <h2>磁盘使用率: <span id="disk-text">{{ disk_percent }}</span>%</h2>
            <div class="progress">
                <div id="disk-bar" class="progress-value"></div>
            </div>
        </div>

        <div class="metric">
            <h2>网络使用情况</h2>
            <div class="network-info">
                <div class="network-item">
                    <strong>已发送：</strong> <span id="network-sent">{{ network.bytes_sent }}</span>
                    <br>
                    <strong>发送速度：</strong> <span id="network-speed-sent">{{ network.speed_sent }}</span>/s
                </div>
                <div class="network-item">
                    <strong>已接收：</strong> <span id="network-recv">{{ network.bytes_recv }}</span>
                    <br>
                    <strong>接收速度：</strong> <span id="network-speed-recv">{{ network.speed_recv }}</span>/s
                </div>
            </div>
        </div>
    </div>

    <script>
        function updateProgressBars() {
            const cpuValue = document.getElementById('cpu-text').textContent;
            const memValue = document.getElementById('mem-text').textContent;
            const diskValue = document.getElementById('disk-text').textContent;

            document.getElementById('cpu-bar').style.width = cpuValue + '%';
            document.getElementById('mem-bar').style.width = memValue + '%';
            document.getElementById('disk-bar').style.width = diskValue + '%';
        }

        // 更新系统信息的函数
        function updateSystemInfo() {
            fetch('/system_info')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('cpu-text').textContent = data.cpu_percent;
                    document.getElementById('mem-text').textContent = data.memory_percent;
                    document.getElementById('disk-text').textContent = data.disk_percent;
                    document.getElementById('network-sent').textContent = data.network.bytes_sent;
                    document.getElementById('network-recv').textContent = data.network.bytes_recv;
                    document.getElementById('network-speed-sent').textContent = data.network.speed_sent;
                    document.getElementById('network-speed-recv').textContent = data.network.speed_recv;
                    updateProgressBars();
                });
        }

        // 每5秒更新一次系统信息
        setInterval(updateSystemInfo, 5000);

        window.onload = updateProgressBars;
    </script>
</body>
</html> 